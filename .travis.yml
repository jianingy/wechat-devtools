language: minimal

dist: xenial

branches:
  only:
    - master

env:
  global:
    - LANG=zh_CN.utf8
    - CACHE_DIR=$TRAVIS_BUILD_DIR/.cache

before_script:
  - sudo ./.travis/deps.sh

script:
  - ./build.sh
  - source ./.travis/push.sh

cache:
  directories:
    - $CACHE_DIR

deploy:
  provider: releases
  api_key:
    secure: "Kf1eO6os601ePkzpjSeW/cBViNtQd90DvX4h6Rv5h8NXT9qp3I1EC9pCrQlI4b29vL/FwZOSrE8EW9yEavITDsYWGmd8WT/z+PdIY2PsHUFGnezsEPzBYjWcp1d/E3SN4By6imF6/NSeMU3ESYeduHyULcot5aUdPQuARDfVRsadToeYuksAhQA4aIiyZ3qHA7ILD9C+r8k3QCmYc5N85FgfkrvJYTFQnAkTMo6U7yux1dMek+iyyVO/1nR6ETd20SiC9AgDdpvp/iVjUzkG+zNKDLkjiIShHK8EDT/pAVgFmEPwi88EIojnQNbG5fjL4gd+Svu6TZfuLnYdUY6d7rn+GZ+RyLm/3OYJaOuGJvBqIdFPryEcXQQPNvIvD482V+0rYUves9f8hkIJF70F3EHe2pygJOR1Ca9pz1/hpgeYo6dRjIM+mHGnJr3ZxZHMU1Ho4/E/NQBzhzGSwmp9fTVaONFxSFHveUvRkJEbB1L76kVmSAFK7V4rPMv12kMjL9Cs9RQoyDFCiNRiRoLo9OeGakl+nYT28WRj+tXTMMKK5QGxb38eYrNhIfjE8HTCmsTb9pnXGLaa8PK5B8dh2dgqvKGlYiqGx/2jx8ec4NPTagt9gykE9UEHry+usfDvieXsgxSfQNuefGsOLFBPq/4k/4WYNibIyIolicESaVI="
  file: wechat-devtools-$TRAVIS_TAG.tar.xz
  skip_cleanup: true
  overwrite: true
  on:
    branch: master
    condition: $TRAVIS_TAG =~ ^[0-9.]+$ 